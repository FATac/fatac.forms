<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
<head>
    <metal:block metal:fill-slot="head_slot">
        <link rel="alternate" title="RSS 1.0" type="application/rss+xml"
              tal:define="here_url context/@@plone_context_state/object_url"
              tal:condition="request/SearchableText|nothing"
              tal:attributes="href string:$here_url/search_rss?${request/QUERY_STRING}"/>
    <script type="text/javascript" src="++resource++fatac.forms.js/jquery.treeview.js"></script>
    <link rel="stylesheet" href="++resource++fatac.forms.js/jquery.treeview.css" />
    
    </metal:block>

    <metal:block fill-slot="top_slot"
                 tal:define="dummy python:request.set('disable_border',1);
                             disable_column_one python:request.set('disable_plone.leftcolumn',1);
                             disable_column_two python:request.set('disable_plone.rightcolumn',1);" />
</head>
    <body i18n:domain="fatac.forms">
    	<metal:content-title fill-slot="content-title">
            <h1 class="documentFirstHeading" i18n:translate="Administracio">Administració</h1>
        </metal:content-title>
        <metal:content-description fill-slot="content-description">
            <div class="documentDescription" i18n:translate="Manteniment">
                Manteniment
            </div>
            <br/>
        </metal:content-description>
        <metal:content-core fill-slot="content-core">
	        <div tal:content="view/action">
	        </div>
	        <br/>
            <ul id="treeview">
                <li><span i18n:translate="RecarregarOntologies">Recarregar ontologies</span>
                	<ul>
                		<li i18n:translate="ActualitzaOntologies">Actualitza les ontologies amb les especificades a la variable de configuració ONTOLOGY_NAMESPACE</li>
                		<li><a href="javascript:void(0);" onclick=" $('#actionInput').val('ontology'); document.manteniment.submit();">Executa</a></li>
                	</ul>
                </li>
                <li>Exportar a OAI
                	<ul>
                		<li>Assegura que les dades actuals estiguin disponibles pel servidor OAI-PMH, d'acord amb allò especificat al oai-mapping <span style="font-weight:bold" >(aquesta acció pot trigar una estona)</span></li>
                		<li><a href="javascript:void(0);" onclick="$('#actionInput').val('oai'); document.manteniment.submit();" i18n:translate="Executa">Executa</a></li>
                	</ul>
                </li>
                <li>Indexar a Solr
                	<ul>
                		<li>Indexa des de zero totes les dades actuals perquè siguin disponibles al motor de cerca Solr, d'acord amb allò especificat al mapping <span style="font-weight:bold" >(aquesta acció pot trigar una estona)</span></li>
                		<li><a href="javascript:void(0);" onclick="$('#actionInput').val('index'); document.manteniment.submit();" i18n:translate="Executa">Executa</a></li>
                		<li>Indexa només les dades recentment introduides o modificades, en el temps establert. No actualitza els objectes esborrats <span style="font-weight:bold" >(aquesta acció pot trigar una estona)</span></li>
                		<li>Introdueix el temps en minuts <input id="minutes" value="60"></li>
                		<li><a href="javascript:void(0);" onclick="$('#actionInput').val('update'); $('#parametreInput').val($('#minutes').val()); document.manteniment.submit();" i18n:translate="Executa">Executa</a></li>
                	</ul>
                </li>
                <li>Generar miniatures
                	<ul>
                		<li>Genera les miniatures de tots els objectes d'una determinada classe. Això és útil per evitar sobrecarregar el servidor durant la cerca <span style="font-weight:bold" >(aquesta acció pot trigar una estona)</span></li>
                		<li>Introdueix el nom de la classe <input id="nomClasse" value=""></li>
                		<li><a href="javascript:void(0);" onclick="$('#actionInput').val('thumbnail'); $('#parametreInput').val($('#nomClasse').val()); document.manteniment.submit();" i18n:translate="Executa">Executa</a></li>
                	</ul>
                </li>
                <li>Substituir textos
                	<ul>
                		<li>Substitueix de cop tots els textos d'un camp especificat. Acció útil per a canviar totes les URL de cop quan es canvia el domini del servidor. Cal indicar: el nom de la propietat que es canviarà (forma "prefix:NomPropietat"), el text a substituir, i el nou text.</li>
                		<li>Nom de la propietat <input id="nomPropietat" value="ac:Uri"></li>
                		<li>Text anterior <input id="textAnterior" value="www.hostanterior.org"></li>
                		<li>Text nou <input id="textNou" value="www.hostnova.org"></li>
                		<li><a href="javascript:void(0);" onclick="$('#actionInput').val('replace'); $('#parametreInput').val($('#nomPropietat').val() + ';' + $('#textAnterior').val() + ';' + $('#textNou').val()); document.manteniment.submit();" i18n:translate="Executa">Executa</a></li>
                	</ul>
                </li>
                <li>Reiniciar rols
                	<ul>
                		<li>Acció necessària perquè els canvis de rol dels usuaris es facin efectius</li>
                		<li><a href="javascript:void(0);" onclick=" $('#actionInput').val('roles'); document.manteniment.submit();" i18n:translate="Executa">Executa</a></li>
                	</ul>
                </li>
                <li>Esborra totes les dades
                	<ul>
                		<li>Esborra <span style="font-weight:bold; color:red;" >de forma irreversible</span> totes les dades del sistema, arxius media, estadístiques i recarrega les ontologies. Per a confirmar aquest acció cal introduir la data i hora actual del servidor (en format tipus '30/11/11 16:37')</li>
                		<li>Introdueix l'hora  del servidor per confirmar <input id="confirmDate" value=""></li>
                		<li><a href="javascript:void(0);" onclick="$('#actionInput').val('reset'); $('#parametreInput').val($('#confirmDate').val()); document.manteniment.submit();" i18n:translate="Executa">Executa</a></li>
                	</ul>
                </li>
            </ul>
            <form name="manteniment" action="manteniment" method="post">
            	<input type="hidden" name="action" id="actionInput">
            	<input type="hidden" name="parametre" id="parametreInput">
            </form>
        </metal:content-core>
    </body>
</html>